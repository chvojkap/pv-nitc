%!TEX root=main.tex
\section{Introduction}\label{sec:intro}

Timed commitments allow to commit to a message with respect to some time parameter $T \in N$, such that (1) the commitment is \emph{binding}, (2) it is \emph{hiding} for time $T$, but (3) it can also forcibly be opened after time $T$ in case the committing party refuses to open the commitment or becomes unavailable. This idea goes back to a seminal work by Rivest, Shamir, and Wagner \cite{RSW96} introducing the strongly related notion of \emph{time-lock puzzles}, and Boneh and Naor~\cite{C:BonNao00} extended this idea to \emph{timed commitments}, which have the additional feature that an opening to the commitment can be efficiently verified (and thus the commitment can be opened efficiently).

\paragraph{Achieving fairness via timed commitments.}
Timed commitmens can be used to achieve \emph{fairness} in secure protocols. For instance, consider a simple auction protocol with $n$ participants (bidders) $B_1, \ldots, B_n$, where every bidder $B_i$ commits to its bid $x_i$ and publishes the commitment $c_i = \com(x_i,r_i)$ using randomness $r_i$. When all bidders have published their commitments, everyone reveals their bid $x_i$ along with $r_i$, such that everyone can publicly verify that the claimed bid $x_i$ is indeed consistent with the initial commitment $c_i$. The bidder with the maximal bid wins the auction.

Now suppose that after the first $(n-1)$ bidders $B_1, \ldots, B_{n-1}$ have opened their commitments $(x_i, r_i)$, the last bidder $B_n$ claims that it has ``lost'' its randomness $r_{i^*}$, e.g., by accidentally deleting it. However, $B_n$ also argues strongly and quite plausibly that it has made the highest bid $x_{i^*}$. This is a difficult situation to resolve in practice:
\begin{itemize}
	\item \emph{$B_n$ might indeed be honest.} In this case, it would be fair to accept its highest bid $x_{i^*}$. One could argue that it is $B_n$'s own fault and thus it should not win the auction, but at the same time a seller might strongly argue to accept the bid, as it is interested in maximising the price, and if $B_n$'s claim is indeed true, then discarding the real highest bit could be considerd unfair by the seller.
	\item \emph{However, $B_n$ might also be cheating.} Maybe it didn't commit to the highest bid, and now $B_n$ tries to ``win'' the auction in an unfair way.
\end{itemize}
Timed commitments can resolve this situation very elegantly and without the need to resort to a trusted third party. To this end, the parties would create their timed commitments $c_i = \com(x_i,r_i, T)$ with respect to a suitable time parameter $T$ for the given application. In case one party indeed is not able to or refuses to open its commitment, the other parties can force the commitment open in time $T$ and thus resolve the dispute. 

Note that it is essential \todo{first challenge is} for a timed commitment to guarantee that the alternative way of opening a commitment, by using the forced decommitment procedure, does not break the \emph{binding} property of the commitment scheme. That is, it is essential that standard opening and forced opening are always guaranteed to decommit to the same message. Otherwise, a malicious party could create a commitment where standard and forced commitments decommit to different values. Then it could decide in the opening phase whether it provide the ``real'' opening or whether it makes the other parties perform the forced opening.

\todo{non-interactive to be practvical}


\paragraph{Non-malleability of commitments.}
Intuitively, non-malleability of a commitment guarantees that no party can turn a given commitment $c$ that decommits to some value $x$ into another commitment $c'$ which decommits to a different value $x'$, such that $x$ and $x'$ are related in some meaningful way.

For instance, in the above example of an auction, $B_n$ could first wait for all other parties to publish their commitments. Then it would select the commitment $c_i$ which most likely contains the highest bid $x_i$, and then exploit the malleability of the commitment scheme to derive from $c_i$ a new commitment $c_n$ which decommits to $x_i + 1$, and then publish this commitment as its own. In this case $B_n$ would be able win the auction with a bid that is only slightly larger than the 2\textsuperscript{nd} highest bit, which does not meet the intuitive security expectations on a secure auctioning protocol.

In order to achieve non-malleability for timed commitments, a recent line of works has explored the idea of \emph{non-malleable time-locked commitments} (and \emph{puzzles}) \todo{what exactly?} \cite{TCC:KatLosXu20,EPRINT:EFKP20a,EC:BDDNO21}.

% Ephraim is FO with TLPs, not homomorphic
% EC21 TLPs in UC, automatically achieve NM, RO, no public verifiability, not homomorphic

Existing constructions of timed commitments are either malleable, rely on the random oracle model, or require the sender of the commitment to invest as much effort to commit to a value as for the receiver to forcibly open the commitment. \todo{reformulate} On top of this, the only known standard model construction due to Katz \etal \cite{TCC:KatLosXu20} relies on of zero-knowledge proofs (NIZK) for general NP relations with very specific properties. 
We provide a simpler and more efficient design paradigm for non-malleable timed commitments, which extends the classical Naor-Yung paradigm \cite{STOC:NaoYun90} to timed commitments, allows for efficient committing in the standard model, and avoids general-purpose ZK proofs by relying on ZK proofs for simple algebraic languages.


\paragraph{Homomorphic commitments.}
Yet another interesting property for practical timed commitments is to allow for homomorphic computations on commitments. This idea was originally introduced by Malavolta and Thyagarajan~\cite{C:MalThy19}, who introduced homomorphic \emph{time-lock puzzles}. Suppose that

\todo{cite versatile, voting, coin flipping, etc., check malavolta paper for hom. application to auctions}

\paragraph{Public verifiability.}
Another interesting property, which has previously not been achieved \todo{for general or for NM timed commitments?} is to achieve public verifiability of a timed commitment. Intuitively, this requires that one can efficiently check whether a commitment is well-formed, such that a forced decommitment will yield a correct result.

Without public verifiability, timed commitments might not provide practical solutions for certain applications. For instance, a malicious party could output a malformed commitment that cannot be opened in time $T$, such that a protocol would fail again in case the malicious party refuses to open the commitment. This could pose a problem in time-sensitive applications, in particular if a large time parameter $T$ is used, and also give rise do Denial-of-Service (DoS) attacks.\todo{stronge arguments? multiple parties}

\todo{explain this is particularly interesting for homomorphisms}


Even in the ROM, this rules out approaches like Fujisaki-Okamoto to achieve NM, since not publicly verifiable. Seems that ZK proofs are required. (But still the Katz et al. construction also doesn't have public verifiability?) Need new approach






\subsection{Our Contribution}
We give an overview of our contributions. 
\begin{enumerate}
\item We begin by extending the formal definitions of prior work to cover additional properties which might be useful for applications. Concretely, we introduce public verifiability of forced opening and meaningful homomorphic properties in the setting of non-malleable non-interactive timed commitments. Public verifiability allows to anyone verify that the claimed opening computed by force is indeed value which is contained in the given commitment. This is useful in settings where forced opening is executed by some third party which is not necessarily trusted. Moreover, if we are only interested in the result of some computation on a set of NITCs, one can instead of force opening all unopened commitments, simply homomorphically combine commitments and then force open the resulting commitment. We remark, that for these to work, one must be sure that all commitments are properly generated, which is easy to check using $\cvrfy$ algorithm of NITC. Hence, one must at first check that all commitments are properly generated, then homomorphically combine commitments to obtain a final commitments, which is then opened by force. If some untrusted party is executing these steps, then everybody is able to verify that computation was executed properly, by verifying that all commitments are generated properly, homomorphically combining commitments and then checking a proof of forced opening that was provided by untrusted party with respect to the final commitment which was computed by us. 
\item Equipped with the necessary formalism, we then give four constructions of non-interactive non-malleable timed commitment. Our construction relies on the variation of double encryption paradigm due to Naor and Yung \cite{STOC:NaoYun90}, which was also leveraged by Katz et al. in their construction. Compared to the generic construction of Katz et al. we do not start from a timed public key encryption scheme, but build our timed commitment from scratch. This lets us avoid two out of the three NIZKs in their construction and lets us replace the third by a simple NIZK proof for the variation of DDH relation over groups of unknown order. Interestingly, we are able to instantiate the given NIZK both in standard model and the random oracle model resulting in different efficiency gains. As for their construction, we support fast opening and verification of commitments (given the opening information) and fast verification of commitments (i.e., a means to check whether they can be forced open to the correct message). Another important benefit of our constructions over that of Katz et al. is that it allows for fast commitment. 
\item\todo{some of the informations in this paragraph are not totally correct} We can also make this construction non-interactive by using a single simulation sound NIZK. This is a far simpler requirement than what is needed for the construction of Katz et al., who need three NIZKs and also require that the simulated prover runs in time independently of the size of a witness. We remark that the (non-interactive) construction of David et al.~\cite{EC:BDDNO21} is in the programmable random oracle model, while ours is in the standard model. By comparison, the work of Ephraim et al. \cite{EPRINT:EFKP20a} (also non-interactive) \emph{does} support fast opening and verification of commitments. On the other hand, their construction is in the auxiliary non-programmable random oracle model (which is slightly stronger than the standard NPROM) and does not allow for fast commitments.
\end{enumerate}

We give a comparison of our schemes with these works in ....



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
