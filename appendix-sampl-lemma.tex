%!TEX root=./main.tex
\section{Proof of  \Cref{sampling-lemma}}\label{proof:smpl-lemma}
\primelemma*


\begin{proof}
The following computation proves the lemma:
\begin{align*}
\sd(X, Y) = \half \sum_{r \in [\floor{N/2}]} \abs{\Pr[X = r] - \Pr[Y = r]} = \\ 
\half \left( \sum_{r = 1}^{\varphi(N)/2} \abs{\Pr[X = r] - \Pr[Y = r]} + \sum_{r = \varphi(N)/2+1}^{\floor{N/2}} \abs{\Pr[X = r] - \Pr[Y = r]} \right) = 
\\
\half \left( \sum_{r = 1}^{\varphi(N)/2} \abs{\frac{1}{\floor{N/2}} - \frac{2}{\varphi(N)}} + \sum_{r = \varphi(N)/2+1}^{\floor{N/2}} \abs{\frac{1}{\floor{N/2}} - 0} \right) \leq \\
\half \left( \sum_{r = 1}^{\varphi(N)/2} \abs{\frac{2}{N} - \frac{2}{\varphi(N)}} + \sum_{r = \varphi(N)/2+1}^{\floor{N/2}} \abs{\frac{1}{\floor{N/2}} - 0} \right) = \\
\half \left( \varphi(N)/2 \abs{\frac{2(\varphi(N) - N)}{\varphi(N)N}} + (\floor{N/2}-\varphi(N)/2) \frac{1}{\floor{N/2}} \right) = \\
 \half \left(\frac{(N-\varphi(N))}{N} + 1 - \frac{\varphi(N)/2}{{\floor{N/2}}} \right) \leq 
\half \left(\frac{(N-\varphi(N))}{N} + 1 - \frac{\varphi(N)/2}{{N/2}} \right) = \\
 \half\frac{2(N-\varphi(N))}{N} = 
\frac{(N-(N-p-q+1))}{N} = \frac{p+q-1}{N} = \frac{1}{p}+\frac{1}{q}-\frac{1}{N}.
\end{align*}
\end{proof}





%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
